<link href="$ctx.siteUrl/gms-res/gms.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="$ctx.siteUrl/js/theme/default/style.css" type="text/css">


#* for debug 
<script src="$ctx.siteUrl/js/OpenLayers-2.10/lib/OpenLayers.js" type="text/javascript"></script> 
*# 
<script src="$ctx.siteUrl/js/OpenLayers.js" type="text/javascript"></script>
 
 
<script src="$ctx.siteUrl/gms-res/js/CMapLayers.js" type="text/javascript"></script>
<script src="$ctx.siteUrl/gms-res/js/CMap.js" type="text/javascript"></script>

<style>
<!--
.debug {
	border: solid red 1px;
}
.debug1 {
	border: solid green 1px;
}
-->
</style>

<div style="border: solid red 1px; padding: 10px;">
	<div style="float: left; width: 210px" class="debug">
		Layers:
		<div id="layers"></div>
	</div>
	<div id="mymap" style="width: 700px; height: 480px; float: left; margin-left: 15px;" class="debug"></div>
	<div class="clear"></div>
</div>

<div id="samplingSiteLegendImg"></div>
<script type="text/javascript">

jQuery(function($) {
	map = new CMap({
		el: "mymap",
		gmsURL: "$ctx.siteUrl/wms"
	});
	
	map.hideAll();
	//map.showLayer('satellite');
	//map.showLayer('samplingsites');
	//map.showLayer('bathymetry');
	
	var names = map.layers.getLayersNames();
	var ct = $("#layers");
	for(var i=0; i<names.length; i++) {
		var name = names[i];
		var id = names[i] + "_id";
		
		var d = $("<div />");
		$('<input type="checkbox" />')
			.attr("name", name)
			.attr("id", id)
			.on('change', function() {
				var n = $(this).attr('name');
				var checked = !! $(this).attr("checked");
				if(checked) {
					map.showLayer(n);
				} else {
					map.hideLayer(n);
				}
			}).appendTo(d);
		$('<label for="'+id+'" />').html(name).appendTo(d);
		d.appendTo(ct);
	}
});

</script>